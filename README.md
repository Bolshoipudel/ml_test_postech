# LLM Assistant - Multi-functional AI Assistant

> ะขะตััะพะฒะพะต ะทะฐะดะฐะฝะธะต ะดะปั ััะฐะถะธัะพะฒะบะธ ะฒ ML ะบะพะผะฐะฝะดั Positive Technologies

ะะฝะพะณะพััะฝะบัะธะพะฝะฐะปัะฝัะน LLM-ะฐััะธััะตะฝั ั ะฒะพะทะผะพะถะฝะพัััะผะธ RAG, SQL-ะทะฐะฟัะพัะพะฒ ะธ ะฒะตะฑ-ะฟะพะธัะบะฐ ะดะปั ะฟัะพะดัะบัะพะฒ Positive Technologies.

## ๐ฏ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

ะัะบะตะฝะด-ัะตัะฒะธั ะธะฝัะตะปะปะตะบััะฐะปัะฝะพะณะพ ะฐััะธััะตะฝัะฐ, ัะฟะพัะพะฑะฝะพะณะพ:
- ๐ **RAG (Retrieval-Augmented Generation)** - ะพัะฒะตัะฐัั ะฝะฐ ะฒะพะฟัะพัั ะฝะฐ ะพัะฝะพะฒะต ะดะพะบัะผะตะฝัะฐัะธะธ
- ๐๏ธ **SQL Agent** - ะธะทะฒะปะตะบะฐัั ะธะฝัะพัะผะฐัะธั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั ะบะพะผะฐะฝะดะฝัั ะฟัะพะตะบัะพะฒ
- ๐ **Web Search** - ะธัะบะฐัั ะฐะบััะฐะปัะฝัั ะธะฝัะพัะผะฐัะธั ะฒ ะธะฝัะตัะฝะตัะต
- ๐ค **Router Agent** - ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒัะฑะธัะฐัั ะฟะพะดัะพะดััะธะน ะธะฝััััะผะตะฝั ะดะปั ะบะฐะถะดะพะณะพ ะทะฐะฟัะพัะฐ

## ๐ ะขะตะบััะธะน ััะฐััั: **ะคะฐะทะฐ 1 ะทะฐะฒะตััะตะฝะฐ (ะะฝััะฐััััะบัััะฐ)** โ

### ะะตะฐะปะธะทะพะฒะฐะฝะพ

#### โ ะะฐะทะพะฒะฐั ะธะฝััะฐััััะบัััะฐ
- FastAPI ะฟัะธะปะพะถะตะฝะธะต ั ะฟะพะปะฝะพะน ะฝะฐัััะพะนะบะพะน
- Pydantic Settings ะดะปั ะบะพะฝัะธะณััะฐัะธะธ
- ะะพะณะธัะพะฒะฐะฝะธะต ัะตัะตะท loguru
- ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ะธ middleware
- Health check endpoint

#### โ API Endpoints
- `POST /api/v1/chat` - ะพัะฝะพะฒะฝะพะน endpoint ะดะปั ัะฐัะฐ
- `GET /api/v1/health` - ะฟัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะตัะฒะธัะฐ
- `POST /api/v1/feedback` - ะพัะฟัะฐะฒะบะฐ ะพะฑัะฐัะฝะพะน ัะฒัะทะธ
- `GET /api/v1/history/{session_id}` - ะฟะพะปััะตะฝะธะต ะธััะพัะธะธ ัะฐัะฐ
- `DELETE /api/v1/history/{session_id}` - ะพัะธััะบะฐ ะธััะพัะธะธ
- `GET /api/v1/stats` - ััะฐัะธััะธะบะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

#### โ ะะฐะทะฐ ะดะฐะฝะฝัั PostgreSQL
ะกะพะทะดะฐะฝะฐ ััะตะผะฐ ะดะปั ะบะพะผะฐะฝะดั ะฟัะพะดัะบัะพะฒ PT:
- `departments` - ะพัะดะตะปั (6 ะทะฐะฟะธัะตะน)
- `products` - ะฟัะพะดัะบัั ะฑะตะทะพะฟะฐัะฝะพััะธ (5 ะฟัะพะดัะบัะพะฒ: PT AI, PT NAD, PT Sandbox, PT MS, PT ISIM)
- `team_members` - ัะปะตะฝั ะบะพะผะฐะฝะดั (12 ัะตะปะพะฒะตะบ)
- `features` - ััะฝะบัะธะธ ะฒ ัะฐะทัะฐะฑะพัะบะต (8 ัะธั)
- `incidents` - ะธะฝัะธะดะตะฝัั ะธ ะฑะฐะณะธ (8 ะธะฝัะธะดะตะฝัะพะฒ)

#### โ Docker ะธะฝััะฐััััะบัััะฐ
- Dockerfile ะดะปั FastAPI ะฟัะธะปะพะถะตะฝะธั
- docker-compose.yml ั PostgreSQL
- ะะฒัะพะผะฐัะธัะตัะบะฐั ะธะฝะธัะธะฐะปะธะทะฐัะธั ะะ
- Health checks ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ

#### โ ะขะตััั
- ะะฐะทะพะฒัะต ัะตััั API endpoints
- Pytest ะบะพะฝัะธะณััะฐัะธั
- Test fixtures

### ๐ง ะ ัะฐะทัะฐะฑะพัะบะต (ะกะปะตะดัััะธะต ัะฐะณะธ)

#### ะคะฐะทะฐ 2: RAG ัะธััะตะผะฐ
- [ ] ะะฐะณััะทะบะฐ ะธ ะธะฝะดะตะบัะฐัะธั ะดะพะบัะผะตะฝัะฐัะธะธ
- [ ] Vector store (ChromaDB)
- [ ] RAG ัะตัะฒะธั ะธ ะฐะณะตะฝั
- [ ] ะะฝัะตะณัะฐัะธั ั chat endpoint

#### ะคะฐะทะฐ 3: SQL Agent
- [ ] ะะพะดะบะปััะตะฝะธะต ะบ PostgreSQL
- [ ] NL-to-SQL ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต
- [ ] Guardrails (ัะพะปัะบะพ SELECT)
- [ ] SQL ะฐะณะตะฝั

#### ะคะฐะทะฐ 4: Web Search Agent
- [ ] ะะฝัะตะณัะฐัะธั Tavily/DuckDuckGo
- [ ] Web search ัะตัะฒะธั
- [ ] Web search ะฐะณะตะฝั

#### ะคะฐะทะฐ 5: Router Agent (ะฏะะะ)
- [ ] ะะปะฐััะธัะธะบะฐัะธั ะทะฐะฟัะพัะพะฒ
- [ ] ะัะฑะพั ะธะฝััััะผะตะฝัะพะฒ
- [ ] ะัะบะตัััะฐัะธั ะฐะณะตะฝัะพะฒ
- [ ] ะะณัะตะณะฐัะธั ัะตะทัะปััะฐัะพะฒ

#### ะคะฐะทะฐ 6: ะะพะบะฐะปัะฝัะต LLM
- [ ] LLM Factory
- [ ] ะะพะดะดะตัะถะบะฐ OpenAI
- [ ] ะะพะดะดะตัะถะบะฐ Ollama
- [ ] ะะตัะตะบะปััะตะฝะธะต ะฟัะพะฒะฐะนะดะตัะพะฒ

#### ะคะฐะทะฐ 7: ะัะตะฝะบะฐ ะบะฐัะตััะฒะฐ
- [ ] ะะฐัะฐัะตั ะดะปั ัะตััะธัะพะฒะฐะฝะธั
- [ ] ะะฝัะตะณัะฐัะธั DeepEval
- [ ] ะะตััะธะบะธ ะบะฐัะตััะฒะฐ
- [ ] ะััะตั ั ัะตะทัะปััะฐัะฐะผะธ

## ๐ ะัััััะน ััะฐัั

### ะขัะตะฑะพะฒะฐะฝะธั
- Python 3.11+
- Docker & Docker Compose (ะพะฟัะธะพะฝะฐะปัะฝะพ)
- PostgreSQL (ะตัะปะธ ะฑะตะท Docker)

### ะฃััะฐะฝะพะฒะบะฐ (ะปะพะบะฐะปัะฝะพ)

1. **ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน**
```bash
git clone <your-repo-url>
cd ml_test_postech
```

2. **ะกะพะทะดะฐะนัะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต**
```bash
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate
```

3. **ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ**
```bash
pip install -r requirements.txt
```

4. **ะะฐัััะพะนัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั**
```bash
# Windows
copy .env.example .env
# Linux/Mac
cp .env.example .env
```

ะััะตะดะฐะบัะธััะนัะต `.env` ะธ ะดะพะฑะฐะฒััะต ะฒะฐัะธ API ะบะปััะธ:
```env
OPENAI_API_KEY=your_key_here
TAVILY_API_KEY=your_key_here  # ะะฟัะธะพะฝะฐะปัะฝะพ ะดะปั web search
```

5. **ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต**
```bash
# Windows
run.bat
# Linux/Mac
./run.sh
```

API ะฑัะดะตั ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั: http://localhost:8000

### ะฃััะฐะฝะพะฒะบะฐ (Docker)

1. **ะกะพะทะดะฐะนัะต .env ัะฐะนะป**
```bash
copy .env.example .env  # Windows
```

2. **ะะฐะฟัััะธัะต ั Docker Compose**
```bash
# Windows
docker-run.bat
# Linux/Mac
docker-compose up --build -d
```

3. **ะัะพะฒะตัััะต ััะฐััั**
```bash
docker-compose ps
docker-compose logs -f app
```

4. **ะััะฐะฝะพะฒะบะฐ**
```bash
# Windows
stop.bat
# Linux/Mac
docker-compose down
```

## ๐ ะะพะบัะผะตะฝัะฐัะธั API

ะะพัะปะต ะทะฐะฟััะบะฐ ะฟัะธะปะพะถะตะฝะธั, ะดะพะบัะผะตะฝัะฐัะธั ะดะพัััะฟะฝะฐ ะฟะพ ะฐะดัะตัะฐะผ:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

### ะัะธะผะตัั ะทะฐะฟัะพัะพะฒ

#### 1. Health Check
```bash
curl http://localhost:8000/api/v1/health
```

#### 2. ะัะฟัะฐะฒะธัั ัะพะพะฑัะตะฝะธะต ะฒ ัะฐั
```bash
curl -X POST http://localhost:8000/api/v1/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ะกะบะพะปัะบะพ ัะตะปะพะฒะตะบ ัะฐะฑะพัะฐะตั ะฝะฐะด PT Application Inspector?",
    "use_history": true
  }'
```

#### 3. ะะพะปััะธัั ะธััะพัะธั
```bash
curl http://localhost:8000/api/v1/history/{session_id}
```

#### 4. ะัะฟัะฐะฒะธัั feedback
```bash
curl -X POST http://localhost:8000/api/v1/feedback \
  -H "Content-Type: application/json" \
  -d '{
    "session_id": "test123",
    "rating": 5,
    "comment": "ะัะปะธัะฝัะน ะพัะฒะตั!"
  }'
```

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโ
โ   Client    โ
โโโโโโโโฌโโโโโโโ
       โ
       โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         FastAPI App                 โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ  โ     Router Agent            โ   โ  โโโ ะัะฑะธัะฐะตั ะฝัะถะฝัะน ะธะฝััััะผะตะฝั
โ  โโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโ   โ
โ           โ                         โ
โ     โโโโโโโดโโโโโโฌโโโโโโโโโโโโโโ   โ
โ     โผ           โผ             โผ   โ
โ  โโโโโโ     โโโโโโโ      โโโโโโโโ โ
โ  โRAG โ     โ SQL โ      โ Web  โ โ
โ  โAgentโ    โAgentโ      โSearchโ โ
โ  โโโโฌโโ    โโโโฌโโโ      โโโโฌโโโโ โ
โโโโโโโผโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโ
      โ        โ             โ
      โผ        โผ             โผ
โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโ
โChromaDB/ โ โPostgreSQLโ โ Tavily/ โ
โ  FAISS   โ โ          โ โDuckDuck โ
โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโ
```

### ะะพะผะฟะพะฝะตะฝัั

1. **API Layer** (`app/api/routes.py`)
   - REST API endpoints
   - ะะฐะปะธะดะฐัะธั ะทะฐะฟัะพัะพะฒ
   - ะััะพัะธั ัะฐัะพะฒ

2. **Agents** (`app/agents/`)
   - Router Agent - ะฒัะฑะพั ะธะฝััััะผะตะฝัะฐ
   - RAG Agent - ัะฐะฑะพัะฐ ั ะดะพะบัะผะตะฝัะฐัะธะตะน
   - SQL Agent - ัะฐะฑะพัะฐ ั ะะ
   - Web Search Agent - ะฟะพะธัะบ ะฒ ะธะฝัะตัะฝะตัะต

3. **Services** (`app/services/`)
   - RAG Service - ะฒะตะบัะพัะฝะพะต ััะฐะฝะธะปะธัะต
   - Database Service - SQL ะทะฐะฟัะพัั
   - Search Service - ะฒะตะฑ-ะฟะพะธัะบ
   - LLM Factory - ัะฟัะฐะฒะปะตะฝะธะต LLM ะฟัะพะฒะฐะนะดะตัะฐะผะธ

4. **Tools** (`app/tools/`)
   - ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ััะธะปะธัั ะดะปั ะฐะณะตะฝัะพะฒ

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะฐะฟััะบ ัะตััะพะฒ
```bash
pytest tests/ -v
```

### ะะฐะฟััะบ ั coverage
```bash
pytest tests/ -v --cov=app --cov-report=html
```

## ๐ ะะฐะทะฐ ะดะฐะฝะฝัั

### ะกัะตะผะฐ
ะะฐะทะฐ ะดะฐะฝะฝัั ัะพะดะตัะถะธั ะธะฝัะพัะผะฐัะธั ะพ ะบะพะผะฐะฝะดะต ะฟัะพะดัะบัะพะฒ Positive Technologies:

- **departments** - ะพัะดะตะปั ะบะพะผะฟะฐะฝะธะธ
- **products** - ะฟัะพะดัะบัั ะฑะตะทะพะฟะฐัะฝะพััะธ
- **team_members** - ัะพัััะดะฝะธะบะธ ั ะฝะฐะฒัะบะฐะผะธ
- **features** - ััะฝะบัะธะธ ะฒ ัะฐะทัะฐะฑะพัะบะต
- **incidents** - ะฑะฐะณะธ ะธ ะธะฝัะธะดะตะฝัั

### ะัะธะผะตัั SQL ะทะฐะฟัะพัะพะฒ
```sql
-- ะกะบะพะปัะบะพ ัะตะปะพะฒะตะบ ัะฐะฑะพัะฐะตั ะฝะฐะด ะบะฐะถะดัะผ ะฟัะพะดัะบัะพะผ
SELECT p.name, COUNT(DISTINCT f.assigned_to) as developers
FROM products p
JOIN features f ON p.id = f.product_id
GROUP BY p.name;

-- ะะบัะธะฒะฝัะต ะธะฝัะธะดะตะฝัั ะฟะพ ะฟัะพะดัะบัะฐะผ
SELECT p.name, COUNT(*) as open_incidents
FROM products p
JOIN incidents i ON p.id = i.product_id
WHERE i.status IN ('open', 'in_progress')
GROUP BY p.name;
```

## ๐ง ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

### Backend
- **FastAPI** - ัะพะฒัะตะผะตะฝะฝัะน ะฒะตะฑ-ััะตะนะผะฒะพัะบ
- **Pydantic** - ะฒะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั
- **SQLAlchemy** - ORM ะดะปั ัะฐะฑะพัั ั ะะ
- **Uvicorn** - ASGI ัะตัะฒะตั

### LLM & AI
- **LangChain** - ััะตะนะผะฒะพัะบ ะดะปั LLM ะฟัะธะปะพะถะตะฝะธะน
- **OpenAI API** - GPT ะผะพะดะตะปะธ
- **ChromaDB** - ะฒะตะบัะพัะฝะพะต ััะฐะฝะธะปะธัะต
- **Sentence Transformers** - embeddings

### Database
- **PostgreSQL** - ะพัะฝะพะฒะฝะฐั ะะ
- **Alembic** - ะผะธะณัะฐัะธะธ

### Search
- **Tavily** - ะฒะตะฑ-ะฟะพะธัะบ API
- **DuckDuckGo** - ะฐะปััะตัะฝะฐัะธะฒะฝัะน ะฟะพะธัะบ

### Testing & Quality
- **Pytest** - ัะตััะธัะพะฒะฐะฝะธะต
- **DeepEval** - ะพัะตะฝะบะฐ ะบะฐัะตััะฒะฐ LLM
- **Black** - ัะพัะผะฐัะธัะพะฒะฐะฝะธะต ะบะพะดะฐ
- **Flake8** - ะปะธะฝัะธะฝะณ

### DevOps
- **Docker** - ะบะพะฝัะตะนะฝะตัะธะทะฐัะธั
- **Docker Compose** - ะพัะบะตัััะฐัะธั

## ๐ Roadmap

- [x] **ะคะฐะทะฐ 1**: ะะฐะทะพะฒะฐั ะธะฝััะฐััััะบัััะฐ โ
- [ ] **ะคะฐะทะฐ 2**: RAG ัะธััะตะผะฐ
- [ ] **ะคะฐะทะฐ 3**: SQL Agent
- [ ] **ะคะฐะทะฐ 4**: Web Search Agent
- [ ] **ะคะฐะทะฐ 5**: Router Agent (ัะดัะพ)
- [ ] **ะคะฐะทะฐ 6**: ะะพะดะดะตัะถะบะฐ ะปะพะบะฐะปัะฝัั LLM
- [ ] **ะคะฐะทะฐ 7**: ะัะตะฝะบะฐ ะบะฐัะตััะฒะฐ

### ะะฟัะธะพะฝะฐะปัะฝัะต ัะธัะธ
- [ ] Deep Search ะดะปั ะฐะฝะฐะปะธัะธะบะธ
- [ ] Guardrails ะดะปั ะฑะตะทะพะฟะฐัะฝะพััะธ
- [ ] Streamlit UI
- [ ] Speech-to-Text ะธะฝัะตะณัะฐัะธั

## ๐ค ะะฐะทัะฐะฑะพัะบะฐ

### ะกัััะบัััะฐ ะฟัะพะตะบัะฐ
```
ml_test_postech/
โโโ app/                    # ะัะฝะพะฒะฝะพะต ะฟัะธะปะพะถะตะฝะธะต
โ   โโโ agents/            # LLM ะฐะณะตะฝัั
โ   โโโ api/               # API endpoints
โ   โโโ models/            # Pydantic ะผะพะดะตะปะธ
โ   โโโ services/          # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ   โโโ tools/             # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ะธะฝััััะผะตะฝัั
โ   โโโ utils/             # ะฃัะธะปะธัั
โ   โโโ config.py          # ะะพะฝัะธะณััะฐัะธั
โ   โโโ main.py            # ะขะพัะบะฐ ะฒัะพะดะฐ
โโโ data/                   # ะะฐะฝะฝัะต
โ   โโโ docs/              # ะะพะบัะผะตะฝัะฐัะธั ะดะปั RAG
โ   โโโ sql/               # SQL ัะบัะธะฟัั
โโโ tests/                  # ะขะตััั
โโโ evaluation/             # ะัะตะฝะบะฐ ะบะฐัะตััะฒะฐ
โโโ docker-compose.yml      # Docker ะบะพะฝัะธะณััะฐัะธั
โโโ requirements.txt        # Python ะทะฐะฒะธัะธะผะพััะธ
โโโ README.md              # ะญัะพั ัะฐะนะป
```

### ะะพะผะฐะฝะดั ัะฐะทัะฐะฑะพัะบะธ
```bash
# ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน
make install

# ะะฐะฟััะบ ะฟัะธะปะพะถะตะฝะธั
make run

# ะะฐะฟััะบ ัะตััะพะฒ
make test

# ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะบะพะดะฐ
make format

# ะะธะฝัะธะฝะณ
make lint

# Docker ะบะพะผะฐะฝะดั
make docker-build
make docker-up
make docker-down
make logs
```

## ๐ ะะธัะตะฝะทะธั

MIT License

## ๐ค ะะฒัะพั

ะขะตััะพะฒะพะต ะทะฐะดะฐะฝะธะต ะดะปั ััะฐะถะธัะพะฒะบะธ ะฒ ML ะบะพะผะฐะฝะดั Positive Technologies

---

**ะกัะฐััั**: ๐ง ะ ัะฐะทัะฐะฑะพัะบะต | **ะคะฐะทะฐ**: 1/7 ะทะฐะฒะตััะตะฝะฐ | **ะะฐัะฐ**: ะะบััะฑัั 2024
