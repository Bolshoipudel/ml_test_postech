# LLM Assistant - ะะฝะพะณะพััะฝะบัะธะพะฝะฐะปัะฝัะน AI ะััะธััะตะฝั

> ะขะตััะพะฒะพะต ะทะฐะดะฐะฝะธะต ะดะปั ััะฐะถะธัะพะฒะบะธ ะฒ ML ะบะพะผะฐะฝะดั Positive Technologies

ะะฝะพะณะพััะฝะบัะธะพะฝะฐะปัะฝัะน LLM-ะฐััะธััะตะฝั ั ะฒะพะทะผะพะถะฝะพัััะผะธ RAG, SQL-ะทะฐะฟัะพัะพะฒ ะธ ะฒะตะฑ-ะฟะพะธัะบะฐ ะดะปั ะฟัะพะดัะบัะพะฒ Positive Technologies.

## ๐ฏ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

ะัะบะตะฝะด-ัะตัะฒะธั ะธะฝัะตะปะปะตะบััะฐะปัะฝะพะณะพ ะฐััะธััะตะฝัะฐ ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะฒัะฑะพัะพะผ ะธะฝััััะผะตะฝัะพะฒ ะดะปั ะพัะฒะตัะฐ ะฝะฐ ะฒะพะฟัะพัั:
- ๐ค **Router Agent** - ะฐะฒัะพะผะฐัะธัะตัะบะธ ะบะปะฐััะธัะธัะธััะตั ะทะฐะฟัะพัั ะธ ะฒัะฑะธัะฐะตั ะฟะพะดัะพะดััะธะน ะธะฝััััะผะตะฝั
- ๐ **RAG (Retrieval-Augmented Generation)** - ะพัะฒะตัะฐะตั ะฝะฐ ะฒะพะฟัะพัั ะฝะฐ ะพัะฝะพะฒะต ะดะพะบัะผะตะฝัะฐัะธะธ ะฟัะพะดัะบัะพะฒ PT
- ๐๏ธ **SQL Agent** - ะธะทะฒะปะตะบะฐะตั ะธะฝัะพัะผะฐัะธั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั ะบะพะผะฐะฝะดะฝัั ะฟัะพะตะบัะพะฒ
- ๐ **Web Search Agent** - ะธัะตั ะฐะบััะฐะปัะฝัั ะธะฝัะพัะผะฐัะธั ะฒ ะธะฝัะตัะฝะตัะต
- ๐ผ **Orchestrator** - ะบะพะพัะดะธะฝะธััะตั ัะฐะฑะพัั ะฝะตัะบะพะปัะบะธั ะฐะณะตะฝัะพะฒ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ

## ๐ ะขะตะบััะธะน ััะฐััั: **ะะกะ ะคะะะซ ะะะะะะะะะะะซ** โ

### โ ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ะบะพะผะฟะพะฝะตะฝัั

#### ๐๏ธ ะะฐะทะพะฒะฐั ะธะฝััะฐััััะบัััะฐ
- โ FastAPI ะฟัะธะปะพะถะตะฝะธะต ั ะฟะพะปะฝะพะน ะฝะฐัััะพะนะบะพะน
- โ Pydantic Settings ะดะปั ะบะพะฝัะธะณััะฐัะธะธ ัะตัะตะท .env
- โ ะกัััะบัััะธัะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ัะตัะตะท loguru
- โ ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ะธ CORS middleware
- โ Health check ะธ ะผะพะฝะธัะพัะธะฝะณ
- โ ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะทะฐะฟัะพัะพะฒ

#### ๐ API Endpoints
```
POST   /api/v1/chat              - ะัะฝะพะฒะฝะพะน endpoint ะดะปั ะพะฑัะตะฝะธั ั ะฐััะธััะตะฝัะพะผ
GET    /api/v1/health            - ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะตัะฒะธัะฐ
POST   /api/v1/feedback          - ะัะฟัะฐะฒะบะฐ ะพะฑัะฐัะฝะพะน ัะฒัะทะธ
GET    /api/v1/history/{id}      - ะะพะปััะตะฝะธะต ะธััะพัะธะธ ัะฐัะฐ
DELETE /api/v1/history/{id}      - ะัะธััะบะฐ ะธััะพัะธะธ ัะตััะธะธ
GET    /api/v1/stats             - ะกัะฐัะธััะธะบะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
GET    /api/v1/rag/stats         - ะกัะฐัะธััะธะบะฐ RAG ะบะพะปะปะตะบัะธะธ
POST   /api/v1/rag/reload        - ะะตัะตะทะฐะณััะทะบะฐ ะดะพะบัะผะตะฝัะพะฒ
GET    /api/v1/rag/debug/{query} - ะัะปะฐะดะบะฐ RAG ะฟะพะธัะบะฐ
```

#### ๐ค Router Agent (ะะฝัะตะปะปะตะบััะฐะปัะฝะฐั ะผะฐัััััะธะทะฐัะธั)
- โ ะะปะฐััะธัะธะบะฐัะธั ะทะฐะฟัะพัะพะฒ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ LLM
- โ ะะฟัะตะดะตะปะตะฝะธะต ะฟะพะดัะพะดััะตะณะพ ะธะฝััััะผะตะฝัะฐ (SQL/RAG/WEB_SEARCH/MULTIPLE)
- โ Few-shot ะฟัะธะผะตัั ะดะปั ัะปัััะตะฝะธั ัะพัะฝะพััะธ
- โ ะัะตะฝะบะฐ ัะฒะตัะตะฝะฝะพััะธ (confidence score)
- โ Fallback ะปะพะณะธะบะฐ ะฟัะธ ะพัะธะฑะบะฐั
- โ ะะพะดะดะตัะถะบะฐ ะบะพะผะฑะธะฝะธัะพะฒะฐะฝะฝัั ะทะฐะฟัะพัะพะฒ (MULTIPLE)

**ะัะธะผะตัั ะผะฐัััััะธะทะฐัะธะธ:**
```python
"ะกะบะพะปัะบะพ ัะฐะทัะฐะฑะพััะธะบะพะฒ ัะฐะฑะพัะฐะตั ะฝะฐะด PT AI?"        โ SQL
"ะงัะพ ัะฐะบะพะต PT Sandbox?"                            โ RAG
"ะะพัะปะตะดะฝะธะต ะฝะพะฒะพััะธ ะฟะพ ะบะธะฑะตัะฑะตะทะพะฟะฐัะฝะพััะธ"           โ WEB_SEARCH
"ะกะบะพะปัะบะพ ัะตะปะพะฒะตะบ ะฒ ะบะพะผะฐะฝะดะต PT AI ะธ ะบะฐะบะธะต ััะฝะบัะธะธ?" โ SQL + RAG
```

#### ๐ RAG Agent (ะะพะบัะผะตะฝัะฐัะธั)
- โ ChromaDB ะดะปั ะฒะตะบัะพัะฝะพะณะพ ััะฐะฝะธะปะธัะฐ
- โ OpenAI Embeddings / Sentence Transformers
- โ ะะฐะณััะทะบะฐ ะธ ะธะฝะดะตะบัะฐัะธั ะดะพะบัะผะตะฝัะพะฒ (Markdown, TXT)
- โ Chunking ั ัะผะฝัะผ ัะฐะทะฑะธะตะฝะธะตะผ ะฟะพ ะฟะฐัะฐะณัะฐัะฐะผ
- โ Semantic search ั ะพัะตะฝะบะพะน ัะตะปะตะฒะฐะฝัะฝะพััะธ
- โ ะะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ ะฝะฐ ะพัะฝะพะฒะต ะบะพะฝัะตะบััะฐ
- โ ะคะธะปัััะฐัะธั ะฟะพ ะผะธะฝะธะผะฐะปัะฝะพะผั ะฟะพัะพะณั ัะตะปะตะฒะฐะฝัะฝะพััะธ
- โ ะะตัะตะทะฐะณััะทะบะฐ ะดะพะบัะผะตะฝัะพะฒ ะฑะตะท ะฟะตัะตะทะฐะฟััะบะฐ

#### ๐๏ธ SQL Agent (ะะฐะทะฐ ะดะฐะฝะฝัั)
- โ Natural Language to SQL ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต
- โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะณะตะฝะตัะฐัะธั SQL ะธะท ะฒะพะฟัะพัะพะฒ
- โ Guardrails ะดะปั ะฑะตะทะพะฟะฐัะฝะพััะธ (ัะพะปัะบะพ SELECT)
- โ ะะฐะปะธะดะฐัะธั SQL ะทะฐะฟัะพัะพะฒ
- โ ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ัะตะทัะปััะฐัะพะฒ ะฒ ะตััะตััะฒะตะฝะฝัะน ัะทัะบ
- โ ะะฐัะธัะฐ ะพั SQL injection
- โ ะกัะตะผะฐ ะะ ั ะฟัะพะดัะบัะฐะผะธ PT

**ะะฐะทะฐ ะดะฐะฝะฝัั ัะพะดะตัะถะธั:**
- `departments` - 6 ะพัะดะตะปะพะฒ
- `products` - 5 ะฟัะพะดัะบัะพะฒ (PT AI, PT NAD, PT Sandbox, PT MS, PT ISIM)
- `team_members` - 12 ัะฐะทัะฐะฑะพััะธะบะพะฒ
- `features` - 8 ัะธั ะฒ ัะฐะทัะฐะฑะพัะบะต
- `incidents` - 8 ะธะฝัะธะดะตะฝัะพะฒ/ะฑะฐะณะพะฒ

#### ๐ Web Search Agent
- โ ะะฝัะตะณัะฐัะธั ั Tavily API
- โ Semantic search ะฒ ะธะฝัะตัะฝะตัะต
- โ ะะพะธัะบ ะฝะพะฒะพััะตะน ะทะฐ N ะดะฝะตะน
- โ ะะตะฝะตัะฐัะธั ะพัะฒะตัะพะฒ ะฝะฐ ะพัะฝะพะฒะต ัะตะทัะปััะฐัะพะฒ ะฟะพะธัะบะฐ
- โ ะะทะฒะปะตัะตะฝะธะต ะธััะพัะฝะธะบะพะฒ ะธ ะดะฐั ะฟัะฑะปะธะบะฐัะธะธ
- โ ะคะธะปัััะฐัะธั ะฟะพ ัะตะปะตะฒะฐะฝัะฝะพััะธ

#### ๐ผ Orchestrator Service
- โ ะะพะพัะดะธะฝะฐัะธั ัะฐะฑะพัั ะฒัะตั ะฐะณะตะฝัะพะฒ
- โ ะะฐัะฐะปะปะตะปัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต ะฝะตัะบะพะปัะบะธั ะฐะณะตะฝัะพะฒ
- โ ะะณัะตะณะฐัะธั ัะตะทัะปััะฐัะพะฒ ะพั ัะฐะทะฝัั ะธััะพัะฝะธะบะพะฒ
- โ ะกะธะฝัะตะท ัะธะฝะฐะปัะฝะพะณะพ ะพัะฒะตัะฐ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ LLM
- โ ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ ั fallback ัััะฐัะตะณะธัะผะธ
- โ ะััะพัะธั ัะฐะทะณะพะฒะพัะพะฒ

#### ๐ง LLM Factory (ะะพะดะดะตัะถะบะฐ ะฟัะพะฒะฐะนะดะตัะพะฒ)
- โ OpenAI API (GPT-4, GPT-3.5)
- โ Ollama ะดะปั ะปะพะบะฐะปัะฝัั ะผะพะดะตะปะตะน
- โ ะะธะฑะบะพะต ะฟะตัะตะบะปััะตะฝะธะต ะฟัะพะฒะฐะนะดะตัะพะฒ
- โ ะะฐัััะพะนะบะฐ temperature ะฟะพะด ะทะฐะดะฐัั
- โ ะฃะฟัะฐะฒะปะตะฝะธะต ัะตัะตะท ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั

#### ๐งช ะขะตััะธัะพะฒะฐะฝะธะต
- โ Unit ัะตััั ะดะปั API
- โ ะขะตััั ะฐะณะตะฝัะพะฒ (SQL, RAG, Web Search, Router)
- โ Pytest fixtures ะธ ะบะพะฝัะธะณััะฐัะธั
- โ ะะฝัะตะณัะฐัะธะพะฝะฝัะต ัะตััั
- โ ะััะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต (test_router_manual.py)

#### ๐ณ Docker Infrastructure
- โ Multi-stage Dockerfile ะดะปั ะพะฟัะธะผะธะทะฐัะธะธ
- โ docker-compose.yml ั PostgreSQL
- โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะธะฝะธัะธะฐะปะธะทะฐัะธั ะะ
- โ Health checks ะดะปั ะฒัะตั ัะตัะฒะธัะพะฒ
- โ Volume ะดะปั ะฟะตััะธััะตะฝัะฝะพััะธ ะดะฐะฝะฝัั

#### ๐ ะะพะบะฐะปะธะทะฐัะธั
- โ **ะัะต ะบะพะผะผะตะฝัะฐัะธะธ ะธ docstrings ะฟะตัะตะฒะตะดะตะฝั ะฝะฐ ััััะบะธะน ัะทัะบ**
- โ **ะฃะดะฐะปะตะฝั ะธะทะฑััะพัะฝัะต ะธ ะพัะตะฒะธะดะฝัะต ะดะพะบัะผะตะฝั-ัััะพะบะธ**
- โ **ะััะฐะฒะปะตะฝะฐ ัะพะปัะบะพ ะธะฝัะพัะผะฐัะธะฒะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั**
- โ ะะพะณะธ ะพััะฐะฒะปะตะฝั ะฝะฐ ะฐะฝะณะปะธะนัะบะพะผ (ััะฐะฝะดะฐััะฝะฐั ะฟัะฐะบัะธะบะฐ)
- โ ะัะพะผะฟัั ะดะปั LLM ะฝะฐ ัะทัะบะฐั ะพัะธะณะธะฝะฐะปะฐ

## ๐ ะัััััะน ััะฐัั

### ะขัะตะฑะพะฒะฐะฝะธั
- Python 3.11+
- Docker & Docker Compose (ัะตะบะพะผะตะฝะดัะตััั)
- PostgreSQL (ะตัะปะธ ะฑะตะท Docker)
- OpenAI API Key
- Tavily API Key (ะพะฟัะธะพะฝะฐะปัะฝะพ, ะดะปั ะฒะตะฑ-ะฟะพะธัะบะฐ)

### ะฃััะฐะฝะพะฒะบะฐ (Docker) - ะะตะบะพะผะตะฝะดัะตััั

1. **ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน**
```bash
git clone <your-repo-url>
cd ml_test_postech
```

2. **ะกะพะทะดะฐะนัะต .env ัะฐะนะป**
```bash
# Windows
copy .env.example .env
# Linux/Mac
cp .env.example .env
```

3. **ะะฐัััะพะนัะต ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั**
ะััะตะดะฐะบัะธััะนัะต `.env` ะธ ะดะพะฑะฐะฒััะต ะฒะฐัะธ API ะบะปััะธ:
```env
# LLM Provider
OPENAI_API_KEY=sk-your_openai_key_here
LLM_PROVIDER=openai
LLM_MODEL=gpt-4.1

# Web Search (ะพะฟัะธะพะฝะฐะปัะฝะพ)
TAVILY_API_KEY=tvly-your_tavily_key_here

# Database
POSTGRES_USER=llm_assistant
POSTGRES_PASSWORD=secure_password
POSTGRES_DB=llm_assistant_db
```

4. **ะะฐะฟัััะธัะต ั Docker Compose**
```bash
docker-compose up --build -d
```

5. **ะัะพะฒะตัััะต ััะฐััั**
```bash
docker-compose ps
docker-compose logs -f app
```

6. **ะะพัััะฟ ะบ API**
- API: http://localhost:8000
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

7. **ะััะฐะฝะพะฒะบะฐ**
```bash
# Windows
stop.bat

# Linux/Mac
docker-compose down
```

### ะฃััะฐะฝะพะฒะบะฐ (ะปะพะบะฐะปัะฝะพ)

1. **ะกะพะทะดะฐะนัะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต**
```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

2. **ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ**
```bash
pip install -r requirements.txt
```

3. **ะะฐัััะพะนัะต PostgreSQL**
```bash
# ะกะพะทะดะฐะนัะต ะะ
createdb llm_assistant_db

# ะะฝะธัะธะฐะปะธะทะธััะนัะต ััะตะผั
psql -d llm_assistant_db -f data/sql/init.sql
```

4. **ะกะพะทะดะฐะนัะต .env ะธ ะฝะฐัััะพะนัะต ะฟะตัะตะผะตะฝะฝัะต**
```bash
copy .env.example .env
```

5. **ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต**
```bash
# Windows
run.bat

# Linux/Mac
python -m uvicorn app.main:app --reload
```

## ๐ ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### 1. ะะพะฟัะพั ะพ ะดะพะบัะผะตะฝัะฐัะธะธ (RAG)
```bash
curl -X POST http://localhost:8000/api/v1/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ะงัะพ ัะฐะบะพะต PT Application Inspector ะธ ะบะฐะบะธะต ั ะฝะตะณะพ ะฒะพะทะผะพะถะฝะพััะธ?"
  }'
```

**ะัะฒะตั:**
```json
{
  "message": "PT Application Inspector (PT AI) - ััะพ ััะฐัะธัะตัะบะธะน ะฐะฝะฐะปะธะทะฐัะพั ะบะพะดะฐ...",
  "tools_used": [
    {
      "tool_type": "router",
      "reasoning": "ะะพะฟัะพั ะพ ะฒะพะทะผะพะถะฝะพัััั ะฟัะพะดัะบัะฐ ััะตะฑัะตั ะฟะพะธัะบะฐ ะฒ ะดะพะบัะผะตะฝัะฐัะธะธ",
      "confidence": 0.9
    },
    {
      "tool_type": "rag",
      "result_summary": "ะะฐะนะดะตะฝะพ 5 ัะตะปะตะฒะฐะฝัะฝัั ะดะพะบัะผะตะฝัะพะฒ"
    }
  ],
  "sources": ["documentation: PT_AI.md", "documentation: PT_Products.md"]
}
```

### 2. SQL ะทะฐะฟัะพั ะบ ะฑะฐะทะต ะดะฐะฝะฝัั
```bash
curl -X POST http://localhost:8000/api/v1/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ะกะบะพะปัะบะพ ัะฐะทัะฐะฑะพััะธะบะพะฒ ัะฐะฑะพัะฐะตั ะฝะฐะด PT Sandbox?"
  }'
```

**ะัะฒะตั:**
```json
{
  "message": "ะะฐะด ะฟัะพะดัะบัะพะผ PT Sandbox ัะฐะฑะพัะฐะตั 3 ัะฐะทัะฐะฑะพััะธะบะฐ...",
  "tools_used": [
    {
      "tool_type": "router",
      "reasoning": "ะะพะฟัะพั ะพ ะบะพะปะธัะตััะฒะต ัะฐะทัะฐะฑะพััะธะบะพะฒ ััะตะฑัะตั ะทะฐะฟัะพัะฐ ะบ ะะ",
      "confidence": 0.95
    },
    {
      "tool_type": "sql",
      "query": "SELECT COUNT(*) FROM team_members...",
      "result_summary": "ะะฐะนะดะตะฝะพ 3 ะทะฐะฟะธัะธ"
    }
  ],
  "sources": ["database: PostgreSQL"]
}
```

### 3. ะะตะฑ-ะฟะพะธัะบ
```bash
curl -X POST http://localhost:8000/api/v1/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ะะฐะบะธะต ะฟะพัะปะตะดะฝะธะต ะฝะพะฒะพััะธ ะฟะพ ะบะธะฑะตัะฑะตะทะพะฟะฐัะฝะพััะธ?"
  }'
```

### 4. ะะพะผะฑะธะฝะธัะพะฒะฐะฝะฝัะน ะทะฐะฟัะพั (ะฝะตัะบะพะปัะบะพ ะฐะณะตะฝัะพะฒ)
```bash
curl -X POST http://localhost:8000/api/v1/chat \
  -H "Content-Type: application/json" \
  -d '{
    "message": "ะกะบะพะปัะบะพ ัะตะปะพะฒะตะบ ะฒ ะบะพะผะฐะฝะดะต PT AI ะธ ะบะฐะบะธะต ั ะฝะตะณะพ ััะฝะบัะธะธ?"
  }'
```

**Router ะฒัะฑะตัะตั:** SQL + RAG โ Orchestrator ะพะฑัะตะดะธะฝะธั ัะตะทัะปััะฐัั

## ๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั

```
                                 โโโโโโโโโโโโโโโ
                                 โ   Client    โ
                                 โโโโโโโโฌโโโโโโโ
                                        โ
                                        โผ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ       FastAPI Application      โ
                        โ      (app/main.py)             โ
                        โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
                                        โ
                                        โผ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ    Orchestrator Service        โ
                        โ  (ะะพะพัะดะธะฝะฐัะธั ะฐะณะตะฝัะพะฒ)         โ
                        โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
                                        โ
                                        โผ
                        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ      Router Agent              โ
                        โ  (ะะปะฐััะธัะธะบะฐัะธั ะทะฐะฟัะพัะพะฒ)      โ
                        โ  โข Few-shot ะฟัะธะผะตัั            โ
                        โ  โข Confidence scoring          โ
                        โ  โข Fallback ะปะพะณะธะบะฐ             โ
                        โโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโ
                                        โ
                    โโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโ
                    โ                   โ                 โ
                    โผ                   โผ                 โผ
        โโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
        โ   RAG Agent      โ  โ  SQL Agent   โ  โ Web Search   โ
        โ                  โ  โ              โ  โ   Agent      โ
        โ โข ChromaDB       โ  โ โข NLโSQL     โ  โ โข Tavily API โ
        โ โข Embeddings     โ  โ โข Guardrails โ  โ โข News       โ
        โ โข Similarity     โ  โ โข Validation โ  โ โข Filtering  โ
        โโโโโโโโโโฌโโโโโโโโโโ  โโโโโโโโฌโโโโโโโโ  โโโโโโโโฌโโโโโโโโ
                 โ                   โ                  โ
                 โผ                   โผ                  โผ
        โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
        โ   ChromaDB   โ    โ  PostgreSQL  โ  โ    Tavily    โ
        โ (ะะพะบัะผะตะฝัั)  โ    โ  (ะะพะผะฐะฝะดะฐ)   โ  โ  (ะะฝัะตัะฝะตั)  โ
        โโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโ
```

### ะะพัะพะบ ะพะฑัะฐะฑะพัะบะธ ะทะฐะฟัะพัะฐ

1. **Client** โ ะพัะฟัะฐะฒะปัะตั ะฒะพะฟัะพั
2. **API Layer** โ ะฒะฐะปะธะดะฐัะธั ะธ ัะพััะฐะฝะตะฝะธะต ะฒ ะธััะพัะธะธ
3. **Orchestrator** โ ะบะพะพัะดะธะฝะฐัะธั ะฟัะพัะตััะฐ
4. **Router Agent** โ ะบะปะฐััะธัะธะบะฐัะธั ะทะฐะฟัะพัะฐ ะธ ะฒัะฑะพั ะธะฝััััะผะตะฝัะฐ(ะพะฒ)
5. **Agent(s)** โ ะฒัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐัะธ (RAG/SQL/Web Search ะธะปะธ ะธั ะบะพะผะฑะธะฝะฐัะธั)
6. **Orchestrator** โ ะฐะณัะตะณะฐัะธั ัะตะทัะปััะฐัะพะฒ ะพั ะฝะตัะบะพะปัะบะธั ะฐะณะตะฝัะพะฒ (ะตัะปะธ ะฝัะถะฝะพ)
7. **API Layer** โ ัะพัะผะธัะพะฒะฐะฝะธะต ะพัะฒะตัะฐ ั ะผะตัะฐะดะฐะฝะฝัะผะธ
8. **Client** โ ะฟะพะปััะฐะตั ะพัะฒะตั ั ะธััะพัะฝะธะบะฐะผะธ

## ๐๏ธ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
ml_test_postech/
โโโ app/                           # ะัะฝะพะฒะฝะพะต ะฟัะธะปะพะถะตะฝะธะต
โ   โโโ agents/                    # ะะณะตะฝัั ะดะปั ัะฐะทะฝัั ะทะฐะดะฐั
โ   โ   โโโ router_agent.py       # โ ะะฐัััััะธะทะฐัะพั ะทะฐะฟัะพัะพะฒ
โ   โ   โโโ rag_agent.py          # โ RAG ะดะปั ะดะพะบัะผะตะฝัะฐัะธะธ
โ   โ   โโโ sql_agent.py          # โ NLโSQL ะฐะณะตะฝั
โ   โ   โโโ web_search_agent.py   # โ ะะตะฑ-ะฟะพะธัะบ
โ   โโโ api/                       # API endpoints
โ   โ   โโโ routes.py             # โ REST API
โ   โโโ models/                    # ะะพะดะตะปะธ ะดะฐะฝะฝัั
โ   โ   โโโ database.py           # โ SQLAlchemy ะผะพะดะตะปะธ
โ   โ   โโโ schemas.py            # โ Pydantic ััะตะผั
โ   โโโ services/                  # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ   โ   โโโ orchestrator_service.py  # โ ะะพะพัะดะธะฝะฐัะธั ะฐะณะตะฝัะพะฒ
โ   โ   โโโ rag_service.py          # โ ะะตะบัะพัะฝะพะต ััะฐะฝะธะปะธัะต
โ   โ   โโโ database_service.py     # โ ะะฐะฑะพัะฐ ั ะะ
โ   โ   โโโ search_service.py       # โ ะะตะฑ-ะฟะพะธัะบ
โ   โ   โโโ llm_factory.py          # โ ะฃะฟัะฐะฒะปะตะฝะธะต LLM
โ   โโโ prompts/                   # ะัะพะผะฟัั ะดะปั LLM
โ   โ   โโโ router_prompts.py     # โ ะัะพะผะฟัั ัะพััะตัะฐ
โ   โโโ utils/                     # ะฃัะธะปะธัั
โ   โ   โโโ document_loader.py    # โ ะะฐะณััะทะบะฐ ะดะพะบัะผะตะฝัะพะฒ
โ   โโโ config.py                  # โ ะะพะฝัะธะณััะฐัะธั
โ   โโโ main.py                    # โ ะขะพัะบะฐ ะฒัะพะดะฐ
โโโ data/                          # ะะฐะฝะฝัะต
โ   โโโ docs/                      # ะะพะบัะผะตะฝัะฐัะธั ะดะปั RAG
โ   โ   โโโ PT_AI.md              # PT Application Inspector
โ   โ   โโโ PT_Sandbox.md         # PT Sandbox
โ   โ   โโโ ...                   # ะััะณะธะต ะฟัะพะดัะบัั
โ   โโโ sql/                       # SQL ัะบัะธะฟัั
โ       โโโ init.sql              # โ ะะฝะธัะธะฐะปะธะทะฐัะธั ะะ
โโโ tests/                         # ะขะตััั
โ   โโโ test_api.py               # โ ะขะตััั API
โ   โโโ test_sql_agent.py         # โ ะขะตััั SQL ะฐะณะตะฝัะฐ
โ   โโโ test_rag_agent.py         # โ ะขะตััั RAG ะฐะณะตะฝัะฐ
โ   โโโ test_web_search_agent.py  # โ ะขะตััั ะฒะตะฑ-ะฟะพะธัะบะฐ
โ   โโโ test_router_agent.py      # โ ะขะตััั ัะพััะตัะฐ
โ   โโโ conftest.py               # Fixtures
โโโ chroma_db/                     # ChromaDB ะฟะตััะธััะตะฝัะฝะพััั
โโโ docker-compose.yml             # โ Docker ะพัะบะตัััะฐัะธั
โโโ Dockerfile                     # โ Docker ะพะฑัะฐะท
โโโ requirements.txt               # โ ะะฐะฒะธัะธะผะพััะธ
โโโ .env.example                   # ะัะธะผะตั ะบะพะฝัะธะณััะฐัะธะธ
โโโ pytest.ini                     # ะะฐัััะพะนะบะธ pytest
โโโ README.md                      # ะญัะพั ัะฐะนะป
```

## ๐ง ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

### Backend & API
- **FastAPI** 0.104+ - ะกะพะฒัะตะผะตะฝะฝัะน async ะฒะตะฑ-ััะตะนะผะฒะพัะบ
- **Pydantic** 2.4+ - ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั ะธ ะฝะฐัััะพะนะบะธ
- **Uvicorn** - ASGI ัะตัะฒะตั

### LLM & AI
- **LangChain** 0.1+ - ะคัะตะนะผะฒะพัะบ ะดะปั LLM ะฟัะธะปะพะถะตะฝะธะน
- **OpenAI API** - GPT-4 / GPT-3.5-turbo
- **Ollama** - ะะพะบะฐะปัะฝัะต LLM ะผะพะดะตะปะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### Vector Database & Embeddings
- **ChromaDB** 0.4+ - ะะตะบัะพัะฝะพะต ััะฐะฝะธะปะธัะต
- **OpenAI Embeddings** - text-embedding-3-small
- **Sentence Transformers** - ะะพะบะฐะปัะฝัะต ัะผะฑะตะดะดะธะฝะณะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

### Relational Database
- **PostgreSQL** 15+ - ะัะฝะพะฒะฝะฐั ะะ
- **SQLAlchemy** 2.0+ - ORM
- **Psycopg2** - PostgreSQL ะฐะดะฐะฟัะตั

### Web Search
- **Tavily** - Semantic search API
- **httpx** - HTTP ะบะปะธะตะฝั

### Testing
- **Pytest** - ะคัะตะนะผะฒะพัะบ ัะตััะธัะพะฒะฐะฝะธั
- **pytest-asyncio** - ะัะธะฝััะพะฝะฝัะต ัะตััั
- **pytest-cov** - Coverage ะพััะตัั

### DevOps
- **Docker** - ะะพะฝัะตะนะฝะตัะธะทะฐัะธั
- **Docker Compose** - ะัะบะตัััะฐัะธั ัะตัะฒะธัะพะฒ

### Utilities
- **Loguru** - ะกัััะบัััะธัะพะฒะฐะฝะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต
- **Python-dotenv** - ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะตัะตะผะตะฝะฝัะผะธ ะพะบััะถะตะฝะธั

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะะฐะฟััะบ ะฒัะตั ัะตััะพะฒ
```bash
pytest tests/ -v
```

### ะะฐะฟััะบ ะบะพะฝะบัะตัะฝะพะณะพ ัะตััะฐ
```bash
pytest tests/test_sql_agent.py -v
pytest tests/test_router_agent.py -v
pytest tests/test_rag_agent.py -v
```

### ะก coverage ะพััััะพะผ
```bash
pytest tests/ -v --cov=app --cov-report=html
```

### ะััะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต Router Agent
```bash
python test_router_manual.py
```

## ๐๏ธ ะะพะฝัะธะณััะฐัะธั

ะัะต ะฝะฐัััะพะนะบะธ ัะฟัะฐะฒะปััััั ัะตัะตะท ะฟะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั ะฒ `.env`:

```env
# ะัะธะปะพะถะตะฝะธะต
APP_NAME=LLM Assistant
APP_VERSION=1.0.0
DEBUG=false
LOG_LEVEL=INFO

# API
API_HOST=0.0.0.0
API_PORT=8000

# LLM Provider (openai ะธะปะธ ollama)
LLM_PROVIDER=openai
LLM_MODEL=gpt-4
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=2000
OPENAI_API_KEY=sk-your_key_here

# Ollama (ะตัะปะธ ะธัะฟะพะปัะทัะตัะต)
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3

# Embeddings (openai ะธะปะธ sentence-transformers)
EMBEDDING_PROVIDER=openai
EMBEDDING_MODEL=text-embedding-3-small

# Vector Store
VECTOR_STORE=chroma
CHROMA_PERSIST_DIRECTORY=./chroma_db
CHUNK_SIZE=1000
CHUNK_OVERLAP=200

# Database
POSTGRES_USER=llm_assistant
POSTGRES_PASSWORD=secure_password
POSTGRES_DB=llm_assistant_db
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Web Search
TAVILY_API_KEY=tvly-your_key_here
WEB_SEARCH_ENABLED=true
MAX_SEARCH_RESULTS=5

# ะะตะทะพะฟะฐัะฝะพััั
ENABLE_GUARDRAILS=true
ALLOWED_SQL_OPERATIONS=SELECT
```

## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะพัะปะฐะดะบะฐ

### ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะตัะฒะธัะฐ
```bash
curl http://localhost:8000/api/v1/health
```

### ะกัะฐัะธััะธะบะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธั
```bash
curl http://localhost:8000/api/v1/stats
```

### ะกัะฐัะธััะธะบะฐ RAG ะบะพะปะปะตะบัะธะธ
```bash
curl http://localhost:8000/api/v1/rag/stats
```

### ะัะปะฐะดะบะฐ RAG ะฟะพะธัะบะฐ
```bash
curl http://localhost:8000/api/v1/rag/debug/PT%20Sandbox
```

### ะะพะณะธ Docker
```bash
docker-compose logs -f app
docker-compose logs -f db
```

## ๐ฏ ะัะธะผะตัั ััะตะฝะฐัะธะตะฒ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะะฝัะพัะผะฐัะธั ะพ ะฟัะพะดัะบัะต
**ะะพะฟัะพั:** "ะะฐััะบะฐะถะธ ะพ PT Network Attack Discovery"
- **Router:** RAG Agent
- **ะััะพัะฝะธะบ:** ะะพะบัะผะตะฝัะฐัะธั
- **ะะตะทัะปััะฐั:** ะะฟะธัะฐะฝะธะต ะฟัะพะดัะบัะฐ, ะฒะพะทะผะพะถะฝะพััะธ, ััะตะฑะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 2: ะกัะฐัะธััะธะบะฐ ะบะพะผะฐะฝะดั
**ะะพะฟัะพั:** "ะกะบะพะปัะบะพ ะพัะบััััั ะธะฝัะธะดะตะฝัะพะฒ ะฟะพ PT Sandbox?"
- **Router:** SQL Agent
- **ะััะพัะฝะธะบ:** PostgreSQL
- **ะะตะทัะปััะฐั:** ะะพะปะธัะตััะฒะพ ั ะดะตัะฐะปะธะทะฐัะธะตะน

### ะกัะตะฝะฐัะธะน 3: ะะบััะฐะปัะฝะฐั ะธะฝัะพัะผะฐัะธั
**ะะพะฟัะพั:** "ะะพัะปะตะดะฝะธะต ะฝะพะฒะพััะธ ะฟะพ Application Security"
- **Router:** Web Search Agent
- **ะััะพัะฝะธะบ:** Tavily (ะธะฝัะตัะฝะตั)
- **ะะตะทัะปััะฐั:** ะกะฒะพะดะบะฐ ะฝะพะฒะพััะตะน ะทะฐ 7 ะดะฝะตะน

### ะกัะตะฝะฐัะธะน 4: ะะพะผะฟะปะตะบัะฝัะน ะทะฐะฟัะพั
**ะะพะฟัะพั:** "ะกะบะพะปัะบะพ ัะตะปะพะฒะตะบ ัะฐะฑะพัะฐะตั ะฝะฐะด PT AI ะธ ะบะฐะบะธะต ั ะฝะตะณะพ ะพัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ?"
- **Router:** MULTIPLE (SQL + RAG)
- **ะััะพัะฝะธะบะธ:** PostgreSQL + ะะพะบัะผะตะฝัะฐัะธั
- **Orchestrator:** ะกะธะฝัะตะทะธััะตั ะตะดะธะฝัะน ะพัะฒะตั
- **ะะตะทัะปััะฐั:** "ะะฐะด PT AI ัะฐะฑะพัะฐะตั 3 ัะฐะทัะฐะฑะพััะธะบะฐ. ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ: SAST ะฐะฝะฐะปะธะท, ะฟะพะดะดะตัะถะบะฐ 30+ ัะทัะบะพะฒ..."

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะะตะฐะปะธะทะพะฒะฐะฝะฝัะต ะผะตัั:
- โ **SQL Guardrails** - ัะพะปัะบะพ SELECT ะทะฐะฟัะพัั ัะฐะทัะตัะตะฝั
- โ **SQL Injection ะทะฐัะธัะฐ** - ะฒะฐะปะธะดะฐัะธั ะธ ะฟัะพะฒะตัะบะฐ ะทะฐะฟัะพัะพะฒ
- โ **ะะฐะฟัะตั ะพะฟะฐัะฝัั ะบะพะผะฐะฝะด** - DROP, DELETE, UPDATE ะทะฐะฑะปะพะบะธัะพะฒะฐะฝั
- โ **ะัะพะฒะตัะบะฐ ะฟะฐััะตัะฝะพะฒ** - ะฑะปะพะบะธัะพะฒะบะฐ xp_, sp_ ะธ ะดััะณะธั ะพะฟะฐัะฝัั ะฟะฐััะตัะฝะพะฒ
- โ **CORS ะฝะฐัััะพะนะบะฐ** - ะฝะฐัััะฐะธะฒะฐะตะผัะต ะฟะพะปะธัะธะบะธ
- โ **ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั** - ััะฒััะฒะธัะตะปัะฝัะต ะดะฐะฝะฝัะต ะฝะต ะฒ ะบะพะดะต

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

### ะะฟัะธะผะธะทะฐัะธะธ:
- ะัะธะฝััะพะฝะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะทะฐะฟัะพัะพะฒ (FastAPI + asyncio)
- ะะฐัะฐะปะปะตะปัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต ะฝะตัะบะพะปัะบะธั ะฐะณะตะฝัะพะฒ
- ะะตัะธัะพะฒะฐะฝะธะต ะฝะฐัััะพะตะบ (lru_cache)
- Connection pooling ะดะปั ะะ
- Batch ะพะฑัะฐะฑะพัะบะฐ ะฒ ChromaDB
- ะะตััะธััะตะฝัะฝะพััั ะฒะตะบัะพัะฝะพะณะพ ััะฐะฝะธะปะธัะฐ

## ๐ Roadmap

### โ ะะตะฐะปะธะทะพะฒะฐะฝะพ
- [x] ะะฐะทะพะฒะฐั ะธะฝััะฐััััะบัััะฐ
- [x] API endpoints
- [x] RAG ัะธััะตะผะฐ ั ChromaDB
- [x] SQL Agent ั guardrails
- [x] Web Search Agent
- [x] Router Agent
- [x] Orchestrator ะดะปั ะบะพะพัะดะธะฝะฐัะธะธ
- [x] LLM Factory (OpenAI + Ollama)
- [x] Docker ะธะฝััะฐััััะบัััะฐ
- [x] ะขะตััั ะฒัะตั ะบะพะผะฟะพะฝะตะฝัะพะฒ
- [x] ะะพะบะฐะปะธะทะฐัะธั ะดะพะบัะผะตะฝัะฐัะธะธ ะฝะฐ ััััะบะธะน

### ๐ฎ ะะพะทะผะพะถะฝัะต ัะปัััะตะฝะธั
- [ ] DeepEval ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะน ะพัะตะฝะบะธ ะบะฐัะตััะฒะฐ
- [ ] Streamlit UI ะดะปั ะดะตะผะพะฝัััะฐัะธะธ
- [ ] Redis ะดะปั ะบะตัะธัะพะฒะฐะฝะธั ะธ ะธััะพัะธะธ
- [ ] ะะพะฝะธัะพัะธะฝะณ ั Prometheus/Grafana
- [ ] CI/CD pipeline
- [ ] Speech-to-Text ะธะฝัะตะณัะฐัะธั
- [ ] Multi-turn ะดะธะฐะปะพะณะธ ั ะบะพะฝัะตะบััะพะผ
- [ ] Fine-tuned Router ะผะพะดะตะปั

## ๐ค ะะฐะทัะฐะฑะพัะบะฐ

### ะกัะธะปั ะบะพะดะฐ
- ะกะปะตะดัะตะผ PEP 8
- Docstrings ะฝะฐ ััััะบะพะผ ัะทัะบะต
- ะะพะณะธ ะฝะฐ ะฐะฝะณะปะธะนัะบะพะผ
- Type hints ะฒะตะทะดะต ะณะดะต ะฒะพะทะผะพะถะฝะพ

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ ะฐะณะตะฝัะฐ
1. ะกะพะทะดะฐะนัะต ัะฐะนะป ะฒ `app/agents/your_agent.py`
2. ะะตะฐะปะธะทัะนัะต ะบะปะฐัั ั ะผะตัะพะดะฐะผะธ `initialize()` ะธ ะพัะฝะพะฒะฝัะผ ะผะตัะพะดะพะผ
3. ะะพะฑะฐะฒััะต ะฒ Router ะฟัะพะผะฟัั ะธ ะปะพะณะธะบั ะบะปะฐััะธัะธะบะฐัะธะธ
4. ะะพะฑะฐะฒััะต ะฒ Orchestrator ะพะฑัะฐะฑะพัะบั ะฝะพะฒะพะณะพ ัะธะฟะฐ
5. ะะฐะฟะธัะธัะต ัะตััั ะฒ `tests/test_your_agent.py`

## ๐ ะะพะปะตะทะฝัะต ัััะปะบะธ

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [LangChain Documentation](https://python.langchain.com/)
- [ChromaDB Documentation](https://docs.trychroma.com/)
- [OpenAI API](https://platform.openai.com/docs/)
- [Tavily API](https://tavily.com/)

## ๐ ะะธัะตะฝะทะธั

MIT License

## ๐ค ะะฒัะพั

ะัะปะพะฒ ะัะธะณะพัะธะน

---

**ะกัะฐััั ะฟัะพะตะบัะฐ:** Production Ready โ

ะัะต ะพัะฝะพะฒะฝัะต ะบะพะผะฟะพะฝะตะฝัั ัะตะฐะปะธะทะพะฒะฐะฝั, ะฟัะพัะตััะธัะพะฒะฐะฝั ะธ ะณะพัะพะฒั ะบ ะธัะฟะพะปัะทะพะฒะฐะฝะธั.
